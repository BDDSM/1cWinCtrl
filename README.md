# 1cWinCtrl - внешняя компонента 1С 

Предназначена для управления окнами Windows, разработана по технологии Native API.

### Возможности компоненты:
- Получение списка окон и списка процессов
- Управление размерами и положением окна
- Получение снимка окна и снимка экрана

### Свойства

- <a href="#CurrentWindow">ТекущееОкно (CurrentWindow)</a>
- <a href="#ActiveWindow">АктивноеОкно (ActiveWindow)</a>
- <a href="#ProcessId">ИдентификаторПроцесса (ProcessId)</a>

### Методы

- <a href="#FindTestClient">НайтиКлиентТестирования (FindTestClient)</a>
- ПолучитьСписокПроцессов (GetProcessList)
- <a href="#GetProcessInfo">ПолучитьДанныеПроцесса (GetProcessInfo)</a>
- ПолучитьСписокОкон (GetWindowList)
- УстановитьРазмерОкна (SetWindowSize)
- УстановитьПозициюОкна (SetWindowPos)
- РазрешитьИзменятьРазмер (EnableResizing)
- ПолучитьСнимокЭкрана (TakeScreenshot)
- ПолучитьСнимокОкна (CaptureWindow)
- ПолучитьЗаголовок (GetWindowText)
- УстановитьЗаголовок (SetWindowText)
- АктивироватьОкно (ActivateWindow)
- РаспахнутьОкно (MaximixeWindow)
- РазвернутьОкно (RestoreWindow)
- СвернутьОкно (MinimizeWindow)

### Сборка проекта

Готовая сборка внешней компоненты находится 
в файле [/Example/Templates/SetWindow/Ext/Template.bin](https://github.com/lintest/1cWinCtrl/raw/master/Example/Templates/SetWindow/Ext/Template.bin)

Порядок самостоятельной сборки внешней компоненты из исходников:
1. Для сборки компоненты необходимо установить Visual Studio Community 2019.
2. Чтобы работала сборка примера обработки EPF надо установить OneScript версии 1.0.20 или выше.
3. Для запуска сборки из исходников надо запустить ./Compile.bat.

***

## Свойства

### <a name="CurrentWindow">ТекущееОкно / CurrentWindow</a>
Тип значения: Целое число (только чтение)
- Дескриптор основного окна приложения 1С, в сеансе которого вызывается внешняя компонента

### <a name="ActiveWindow">АктивноеОкно / ActiveWindow</a>
Тип значения: Целое число (только чтение)
- Дескриптор приоритетного окна (окна, с которым пользователь в настоящее время работает). 

### <a name="ProcessId">ИдентификаторПроцесса / ProcessId</a>
Тип значения: Целое число (только чтение)
- Идентификатор основного процесса приложения 1С, в сеансе которого вызывается внешняя компонента

## Методы
### <a name="FindTestClient">НайтиКлиентТестирования(НомерПорта, ВозвращаемыеДанные) / FindTestClient</a>
Возвращает дескриптор главного окна клиента тестирования 1С по номеру порта, 
который был указан в командной строке при запуске приложения,
а также всю доступную информацию о процессе.

Параметры функции
- **НомерПорта** (обязательный), Тип: Целое число
- **ВозвращаемыеДанные** (необязательный), Тип: Неопределено

Тип возвращаемого значения: Целое число
- Дескриптор найденного окна клиента тестирования
- Нулевое значение, если клиент тестирования не найден

Второй параметр функции **ВозвращаемыеДанные** после вызова функции содержит строку с текстом в формате
JSON, при чтении которого получаем объект типа ***Структура*** с подробной информацией о процессе.

```bsl

ВозвращаемыеДанные = Неопределено;
ДескрипторОкна = ВнешняяКомпонента.НайтиКлиентТестирования(ПортПодключения, ВозвращаемыеДанные);
ЧтениеJSON = Новый ЧтениеJSON();
ЧтениеJSON.УстановитьСтроку(ВозвращаемыеДанные);
СтруктураДанныхПроцесса = ПрочитатьJSON(ЧтениеJSON);

```

### <a name="GetProcessInfo">ПолучитьДанныеПроцесса(ИдентификаторПроцесса) / GetProcessInfo</a>
По идентификатору процесса возвращает всю доступную информацию о процессе.

Параметры функции
- **ИдентификаторПроцесса** (обязательный), Тип: Целое число

Тип возвращаемого значения: Строка
- Содержит строку с текстом в формате JSON, при чтении которого получаем
объект типа ***Структура*** с подробной информацией о процессе.

```bsl

ТекстJSON = ВнешняяКомпонента.ПолучитьДанныеПроцесса(ИдентификаторПроцесса);
ЧтениеJSON = Новый ЧтениеJSON();
ЧтениеJSON.УстановитьСтроку(ТекстJSON);
СтруктураДанныхПроцесса = ПрочитатьJSON(ЧтениеJSON);

```
